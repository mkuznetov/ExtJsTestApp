"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var _stringify=require("babel-runtime/core-js/json/stringify"),_stringify2=_interopRequireDefault(_stringify),_typeof2=require("babel-runtime/helpers/typeof"),_typeof3=_interopRequireDefault(_typeof2),_assign=require("babel-runtime/core-js/object/assign"),_assign2=_interopRequireDefault(_assign),_getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn"),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=require("babel-runtime/helpers/inherits"),_inherits3=_interopRequireDefault(_inherits2),ReporterBase=require("../reporter/ReporterBase"),EventRecorderReporter=function(a){function b(){return(0,_classCallCheck3["default"])(this,b),(0,_possibleConstructorReturn3["default"])(this,(b.__proto__||(0,_getPrototypeOf2["default"])(b)).apply(this,arguments))}return(0,_inherits3["default"])(b,a),(0,_createClass3["default"])(b,[{key:"ctor",value:function(a){(0,_assign2["default"])(this,a),this.recordEnabledTests=[]}},{key:"testRunStarted",value:function(a){var b=a.agent;this.runner.fire({type:"testrunstarted",agent:b,message:a})}},{key:"testRunFinished",value:function(a){var b=a.agent;this.runner.fire({type:"testrunfinished",agent:b,message:a})}},{key:"recordingStarted",value:function(a){this.runner.fire("recordingstarted")}},{key:"recordingStopped",value:function(a){this.runner.agent.terminate(),this.runner.fire("recordingstopped")}},{key:"recordedEvents",value:function(a){this.runner.fire({type:"recordedevents",events:a.events})}},{key:"testAdded",value:function(a){var b=a.testDef;b.recording&&this.recordEnabledTests.push(b)}},{key:"afterFiles",value:function(a){var b=a.agent,c=this.recordEnabledTests.length;0===c?this.runner.fire({type:"recordingerror",message:"no recording enabled tests detected"}):c>1?this.runner.fire({type:"recordingerror",message:"multiple recording enabled tests detected",tests:this.recordEnabledTests}):(this.runner.recordAgent=b,b.startTestRun(null,this.recordEnabledTests.map(function(a){return a.id})))}},{key:"systemError",value:function(a){var b=this,c=a.agent,d=a.error||a.message;"object"===("undefined"==typeof d?"undefined":(0,_typeof3["default"])(d))&&(d=(0,_stringify2["default"])(d,null,4)),Studio.alert(d),b.isRecording&&c.stopRecording(),Ext.fireEvent("systemerror",a)}}]),b}(ReporterBase);module.exports=EventRecorderReporter;