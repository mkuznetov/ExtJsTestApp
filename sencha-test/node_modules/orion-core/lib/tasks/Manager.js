"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var _assign=require("babel-runtime/core-js/object/assign"),_assign2=_interopRequireDefault(_assign),_getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn"),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=require("babel-runtime/helpers/inherits"),_inherits3=_interopRequireDefault(_inherits2),Observable=require("../Observable"),Manager=function(a){function b(a){(0,_classCallCheck3["default"])(this,b);var c=(0,_possibleConstructorReturn3["default"])(this,(b.__proto__||(0,_getPrototypeOf2["default"])(b)).call(this)),d=c;return(0,_assign2["default"])(d,a),d.tasks={},process.on("beforeExit",d.cleanupTasks.bind(d)),process.on("exit",d.cleanupTasks.bind(d)),process.on("SIGINT",d.cleanupTasks.bind(d)),c}return(0,_inherits3["default"])(b,a),(0,_createClass3["default"])(b,[{key:"cleanupTasks",value:function(){var a=this;for(var b in a.tasks)try{a.tasks[b].stop()}catch(c){}}},{key:"getTask",value:function(a){return"string"!=typeof a&&(a=a.id||a.taskId),this.tasks[a]}},{key:"addTask",value:function(a){var b=this;b.tasks[a.id]=a,b.fire({type:"taskCreated",task:a}),a.on({scope:this,complete:function(){b.removeTask(a)}})}},{key:"removeTask",value:function(a){var b=this;b.tasks[a.id]=null,b.fire({type:"taskRemoved",task:a})}}]),b}(Observable);module.exports=new Manager;