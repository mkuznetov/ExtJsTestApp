"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn"),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_get2=require("babel-runtime/helpers/get"),_get3=_interopRequireDefault(_get2),_inherits2=require("babel-runtime/helpers/inherits"),_inherits3=_interopRequireDefault(_inherits2),co=require("co"),util=require("util"),Agent=require("./Agent"),SandboxBrowser=require("orion-core/lib/model/browser/SandboxBrowser"),SandboxAgent=function(a){function b(){return(0,_classCallCheck3["default"])(this,b),(0,_possibleConstructorReturn3["default"])(this,(b.__proto__||(0,_getPrototypeOf2["default"])(b)).apply(this,arguments))}return(0,_inherits3["default"])(b,a),(0,_createClass3["default"])(b,[{key:"launch",value:function(){var a,b=this,c=b.agentGroup.browser;return a=b.sandboxBrowser=new SandboxBrowser({browser:c,proxyPort:b.runner.proxy.port,url:b.url,agent:b}),a.launch()}},{key:"getTestOptions",value:function(){var a=(0,_get3["default"])(b.prototype.__proto__||(0,_getPrototypeOf2["default"])(b.prototype),"getTestOptions",this).call(this);return a.driverConfig=this.sandboxBrowser.getDriverConfig(),a.subjectUrl=this.runner.getSubjectUrl(),a.proxyPort=this.runner.proxy.port,a}},{key:"screenshot",value:function(a){var b=this;if(b.archiver&&b.archiver.enableScreenshots)return b.archiver.saveScreenshot(a.name,a.data,b)}},{key:"terminate",value:function(){var a=this;a.isRunning=!1,a.fire({type:"terminated",agent:a}),a.sendMessage({type:"terminated"},!0),a.sandboxBrowser&&a.sandboxBrowser.task.proc.connected&&a.sandboxBrowser.terminate()}},{key:"browserFullName",get:function(){return this.agentGroup.browser.displayLabel}},{key:"userAgentString",get:function(){return null}}],[{key:"meta",get:function(){return{prototype:{contextType:"webdriver",isSandboxAgent:!0,terminateOnFinish:!0}}}}]),b}(Agent);module.exports=SandboxAgent;