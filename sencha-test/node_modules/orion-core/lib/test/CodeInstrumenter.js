"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var _assign=require("babel-runtime/core-js/object/assign"),_assign2=_interopRequireDefault(_assign),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),os=require("os"),istanbul=require("istanbul"),CodeInstrumenter=function(){function a(b){(0,_classCallCheck3["default"])(this,a);var c=this;(0,_assign2["default"])(c,b),c.size=c.size||os.cpus().length,c.workers=[],c.listeners={},c.instrumenter=new istanbul.Instrumenter({embedSource:!0})}return(0,_createClass3["default"])(a,[{key:"getFilters",value:function(){var a,b,c=this,d=c.scenario,e=c.filters;return e||(e=[],d&&(a=d.coverageFilters||d.data.coverageFilters,a&&a.forEach(function(a){a.disabled||e.push(new RegExp(a.path))}),b=d.project,b&&(a=b.coverageFilters||b.data.coverageFilters,a&&a.forEach(function(a){a.disabled||e.push(new RegExp(a.path))}))),c.filters=e),e}},{key:"instrument",value:function(a,b){var c=this,d=c.getFilters(),e=d.length;if(e)for(var f=0;f<e;f++)if(d[f].test(b))return a;return c.instrumenter.instrumentSync(a,b)}}]),a}();module.exports=CodeInstrumenter;