"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),Util=require("orion-core/lib/Util"),fs=require("fs"),path=require("path"),File=require("./fs/File"),slashRe=/\\/g,os=require("os"),uuid=require("uuid"),xfs={splitRe:/[\/\\]/g,separator:File.separator,session:"session",homeDir:new File(os.homedir()),setTempDir:function(a){var b=xfs;a.$isFile||(a=new File(a)),b.tempDir=new File(a,"Sencha-Studio"),b.tempSessionDir=new File(b.tempDir,b.session),b.tempSessionDir.remove().then(function(a){b.tempSessionDir.ensurePathExists()}),b.tempSessionDir.removeOnExit()},exists:function(a,b){return"function"!=typeof b?new File(a).exists():void new File(a).exists().then(function(a){b(a)})["catch"](function(a){console.error(a.stack||a)})},existsSync:function(a){try{return fs.accessSync(a,fs.F_OK),!0}catch(b){return!1}},normalize:function(a){return(a||"").replace(slashRe,"/")},wrapError:function(a,b){return File.wrapError(a,b)},dirList:function(a,b){return new File(a).getFiles(b)},dirListSync:function(a,b){return new File(a).getFilesSync(b)},listAllFilesSync:function(a){return xfs.dirListSync(a,!0)},isDirectory:function(a){return new File(a).isDirectory()},isFile:function(a){return new File(a).isFile()},join:function(){return File.join.apply(File,arguments)},flatten:function(a){return File.flatten(a)},resolve:function(){return path.resolve.apply(path,arguments)},split:function(a){return File.split(a)},getRelativePath:function(a,b){return new File(a).relativeTo(b).path},mkdir:function(a){return new File(a).ensurePathExists()},writeFile:function(a,b,c){return new File(a).write(b,c)},removeFile:function(a){return new File(a).remove()},copy:function(a,b){return new _promise2["default"](function(c,d){function e(a){f||(a?d(a):c(),f=!0)}var f=!1;a+="",b+="";var g=fs.createReadStream(a);g.on("error",function(a){e(a)});var h=fs.createWriteStream(b);h.on("error",function(a){e(a)}),h.on("close",function(a){e()}),g.pipe(h)})},rename:function(a,b){return new _promise2["default"](function(c,d){fs.rename(a,b,function(a){a?d(a):c()})})},readFile:function(a,b){return new File(a).read(b)},setBinDir:function(a,b){if(b){do name=a.name,a=a.parent;while("app.asar"!==name);a=Util.isMac?a.parent.parent.parent:a.parent,this.filesDir=a}else this.filesDir=a.join("files");this.binDir=a}};xfs.setTempDir(os.tmpdir()),xfs.profileDir=new File(function(){var a=os.homedir();switch(os.platform()){case"win32":return xfs.join(process.env.USERPROFILE,".sencha");case"darwin":return xfs.join(a,"Library/Application Support/Sencha");case"linux":return xfs.join(a,".local/share/data/Sencha")}return xfs.join(a,".sencha")}()),xfs.seleniumDir=new File(function(){var a=xfs.profileDir;return xfs.join(a.path,"Studio","selenium")}()),xfs.electronDir=new File(function(){var a;try{a=require("electron")}catch(b){if(a=process.execPath,Util.isMac){var c="/Frameworks/Sencha Studio Helper.app/Contents/MacOS/Sencha Studio Helper",d="/MacOS/Sencha Studio";a=a.replace(c,d)}}return a}()),module.exports=xfs;