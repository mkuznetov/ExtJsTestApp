"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn"),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_get2=require("babel-runtime/helpers/get"),_get3=_interopRequireDefault(_get2),_inherits2=require("babel-runtime/helpers/inherits"),_inherits3=_interopRequireDefault(_inherits2),Entity=require("../Entity.js"),Configuration=require("../../config/Configuration"),Package=require("./Package"),Testable=require("../Testable"),Framework=function(a){function b(){return(0,_classCallCheck3["default"])(this,b),(0,_possibleConstructorReturn3["default"])(this,(b.__proto__||(0,_getPrototypeOf2["default"])(b)).apply(this,arguments))}return(0,_inherits3["default"])(b,a),(0,_createClass3["default"])(b,[{key:"getName",value:function(){var a=this.data;return a?a.summary+" "+a.version:(0,_get3["default"])(b.prototype.__proto__||(0,_getPrototypeOf2["default"])(b.prototype),"getName",this).call(this)}},{key:"resolveVariables",value:function(a){return(0,_get3["default"])(b.prototype.__proto__||(0,_getPrototypeOf2["default"])(b.prototype),"resolveVariables",this).call(this,a).split("${framework.dir}").join(this.dir)}},{key:"setSourceFile",value:function(a){if(this.data.dependencies)throw new Error("Not a valid Sencha Framework: "+a);return(0,_get3["default"])(b.prototype.__proto__||(0,_getPrototypeOf2["default"])(b.prototype),"setSourceFile",this).call(this,a)}}],[{key:"load",value:function(a,c,d){return"boolean"==typeof c&&(d=c,c=null),new _promise2["default"](function(e,f){var g=new Configuration;Entity.load.call(b,a,c,d).then(function(d){if(d.error){var f=a+"/cmd/sencha.cfg";g.load(f).then(function(){var d=g.get("framework.name"),h="ext"===d,i=h?"Ext JS":"Sencha Touch",j=new b({name:d,type:"framework",namespace:"Ext",classpath:g.get("framework.classpath"),creator:"Sencha",summary:i,detailedDescription:(h?"Sencha Ext JS":i)+" JavaScript Framework",version:g.get("framework.version")});c&&j.setOwner(c),j.path=f,j.dir=a,e(j)},function(c){var d=new b;d.dir=a,d.error=c,d.relativePath=a,e(d)})}else e(d)})})}},{key:"meta",get:function(){return{prototype:{isFramework:!0}}}},{key:"configPath",get:function(){return"cmd/sencha.cfg"}},{key:"kind",get:function(){return"Framework"}}]),b}(Package);module.exports=Framework;